import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import quandl
from statsmodels.tsa.stattools import adfuller
from scipy import stats


class Cointegrator(object):
  def __init__(self, x, y): # using these classic tickers instead of stock1 and stock2
    if x[-1] > y[-1]:
      self.X = np.array(quandl.get("WIKI/" + y).loc[:, "Close"].tolist())
      self.Y = np.array(quandl.get("WIKI/" + x).loc[:, "Close"].tolist())
    else:
      self.X = np.array(quandl.get("WIKI/" + x).loc[:, "Close"].tolist())
      self.Y = np.array(quandl.get("WIKI/" + y).loc[:, "Close"].tolist())
    if len(self.X) > len(self.Y):
      self.X = self.X[-len(self.Y):]
    else:
      self.Y = self.Y[-len(self.X):]
    self.diffX, self.diffY = np.diff(self.X), np.diff(self.Y)
     
   
  def adf(self):
    X = adfuller(self.diffX)[1]
    Y = adfuller(self.diffY)[1]
    if X < .05 and Y < .05:
      return True
    else:
      return False
  
  def engel_granger(self):
    adf = self.adf()
    if adf:
      if np.nanmean(self.diffX) > np.nanmean(self.diffY):
        
      ws = stats.linregress([self.jpm, self.gs])[:2]
    else:    
      ws = stats.linregress([self.gs, self.jpm])[:2]
    
